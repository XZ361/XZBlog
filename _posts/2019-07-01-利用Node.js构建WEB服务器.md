---
layout:     post
title:      åˆ©ç”¨Nodejs æ„å»º WEBæœåŠ¡å™¨
subtitle:   node.jsæ„å»ºæœåŠ¡å™¨
date:       2019-07-01
author:     XZ
header-img: img/post-bg-miui6.jpg
catalog: true
tags:
    - node
    - WEBæœåŠ¡å™¨
---

## å‰è¨€

Web æœåŠ¡å™¨ä¸€èˆ¬æŒ‡ç½‘ç«™æœåŠ¡å™¨ï¼Œæ˜¯æŒ‡é©»ç•™äºå› ç‰¹ç½‘ä¸ŠæŸç§ç±»å‹è®¡ç®—æœºçš„ç¨‹åºï¼Œå¯ä»¥_å‘æµè§ˆå™¨ç­‰ Web å®¢æˆ·ç«¯æä¾›æ–‡æ¡£_ï¼Œä¹Ÿå¯ä»¥*æ”¾ç½®ç½‘ç«™æ–‡ä»¶ï¼Œè®©å…¨ä¸–ç•Œæµè§ˆ*ï¼›å¯ä»¥*æ”¾ç½®æ•°æ®æ–‡ä»¶ï¼Œè®©å…¨ä¸–ç•Œä¸‹è½½*ã€‚ç›®å‰æœ€ä¸»æµçš„ä¸‰ä¸ª Web æœåŠ¡å™¨æ˜¯ Apache Nginx IISã€‚åºŸè¯ä¸å¤šè¯´ï¼Œæ¥çœ‹çœ‹æœ¬æ¬¡åˆ†äº« éƒ½æœ‰å“ªäº›äº®ç‚¹å§!


## ä¸€ã€Nodejs æ„å»ºç®€å•çš„ WEB æœåŠ¡å™¨

>å…³é”®è¯ï¼šWebæœåŠ¡å™¨ Node.js

### 1. å¼•å…¥ HTTP æ¨¡å—

    const http = require('http')

### 2. ç”¨ HTTPæ¨¡å— åˆ›å»ºæœåŠ¡

    const Server=http.createServer((req,res)=>{
        // å‘é€ HTTP å¤´éƒ¨
        // HTTP çŠ¶æ€å€¼: 200 : OK
        //è®¾ç½® HTTP å¤´éƒ¨ï¼ŒçŠ¶æ€ç æ˜¯ 200ï¼Œæ–‡ä»¶ç±»å‹æ˜¯ htmlï¼Œå­—ç¬¦é›†æ˜¯ utf-8
        
        res.writeHead(200,{"Content-Type":"text/html;charset='utf-8'"});
        
        res.write('ä½ å¥½ nodejs');
        
        res.write('æˆ‘æ˜¯ç¬¬ä¸€ä¸ª nodejs ç¨‹åº');
        
        res.end(); /*ç»“æŸå“åº”*/
    })

    Server.listen('8001')

![](http://tva1.sinaimg.cn/large/0060lm7Tly1g4kovr0wzmj30p00dwq58.jpg)

### 3. ç”¨HTTPæ¨¡å—ã€fsæ¨¡å—ã€urlæ¨¡å—ã€pathæ¨¡å—æ¥æ­å»ºä¸€ä¸ªé™æ€webæœåŠ¡å™¨

    /* 
        é€šè¿‡nodejs ä¸­çš„  
        HTTPæ¨¡å—ã€URLæ¨¡å—ã€fsæ¨¡å—ã€Pathæ¨¡å—
        æ¥æ„å»ºé™æ€èµ„æºæœåŠ¡å™¨
    */
    // å¼•å…¥HTTPæ¨¡å—æ¥åˆ›å»ºwebæœåŠ¡å™¨
    var http = require('http')
        // å¼•å…¥fsæ¨¡å—æ¥è¿›è¡Œæ–‡ä»¶æ“ä½œ
    var fs = require('fs')
        // å¼•å…¥pathæ¨¡å—ï¼Œå¯ä»¥æ‹¿åˆ°è¯·æ±‚æ–‡ä»¶çš„åç¼€å
    var path = require('path')
        // å¼•å…¥urlæ¨¡å—æ¥å¤„ç†è¯·æ±‚çš„æ•°æ®
    var url = require('url')

    // å¼•å…¥è‡ªå®šä¹‰æ¨¡å—,è·å–`å¾—åˆ°åç¼€å`çš„å‡½æ•°

    var mimeModel = require('./model/getmime.js');

    http.createServer((req, res) => {


        // res.write('hello node.js')
        // http://localhost:8001/news.html       /news.html
        // http://localhost:8001/index.html      /index.html

        var pathname = url.parse(req.url).pathname;   //é€šè¿‡url.parse()ç›´æ¥è·å–è¯·æ±‚çš„æ•°æ®è·¯å¾„

        // è¿‡æ»¤è¯·æ±‚
        if (pathname == '/') {
            pathname = 'index.html'; //é»˜è®¤åŠ è½½é¦–é¡µ
        }
        // è·å–æ–‡ä»¶çš„åç¼€åï¼Œæ ¹æ®ä¸åŒçš„åç¼€åè¿”å›ä¸åŒçš„ä¿¡æ¯
        var extname = path.extname(pathname);

        if (pathname != '/favicon.ico') {

            // é€šè¿‡æ–‡ä»¶æ“ä½œæ¥è·å–staticä¸‹é¢çš„index.html

            fs.readFile('./åˆ›å»ºWEBæœåŠ¡å™¨/static/' + pathname, (err, result) => {

                if (err) {
                    fs.readFile('./åˆ›å»ºWEBæœåŠ¡å™¨/static/404.html', (error, data) => {
                        if (error) {
                            console.log(error)
                            return
                        }
                        res.writeHead(404, { "Content-Type": "text/html;charset='utf-8' " });

                        res.write(data);
                        res.end() //ç»“æŸå“åº”
                    })
                } else {
                    // è¿™å°±å®ç°äº†æœ€åŸºæœ¬çš„é™æ€webæœåŠ¡

                    // å“åº”å¤´
                    var mime = mimeModel.getMime(extname); //è·å–æ–‡ä»¶ç±»å‹
                    res.writeHead(200, { "Content-Type": "" + mime + ";charset='utf-8' " });

                    res.write(result);
                    res.end() //ç»“æŸå“åº”
                }
            })


        }

    }).listen(8001)

## ç»“è¯­

OKï¼Œè¿™æ¬¡çš„ åˆ†äº«åˆ°è¿™å°±ç»“æŸäº†ï¼Œè™½ç„¶çœ‹èµ·æ¥æ„å»ºWEBé™æ€èµ„æºæœåŠ¡å™¨ç®€å•ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦åŠ¨æ‰‹ç»ƒä¹ æ‰èƒ½ğŸ˜œæœ‰æ›´æ·±åˆ»çš„ç†è§£ï¼ŒåŠ©ä½  o(*ï¿£â–½ï¿£*)o æˆé•¿é¡ºåˆ©ï¼

### å‚è€ƒ

- [node.js å­¦ä¹ ç¤¾åŒº](https://http://www.nodeclass.com/)
- [node.js ä¸“ä¸šä¸­æ–‡ç¤¾åŒº](https://https://cnodejs.org/)
- [nodeç¬”è®°- æ­å»ºé™æ€èµ„æºæœåŠ¡å™¨](https://zhuanlan.zhihu.com/p/47789809)
